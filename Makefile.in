prefix  = @ac_prefix@
qmake   = @ac_qmake@
lupdate = @ac_lupdate@
lrelease = @ac_lrelease@

name    = qjackctl

headers = config.h \
	src/qjackctlAbout.h \
	src/qjackctlAlsaConnect.h \
	src/qjackctlConnect.h \
	src/qjackctlConnectAlias.h \
	src/qjackctlJackConnect.h \
	src/qjackctlPatchbay.h \
	src/qjackctlPatchbayFile.h \
	src/qjackctlPatchbayRack.h \
	src/qjackctlSetup.h \
	src/qjackctlStatus.h \
	src/qjackctlSystemTray.h \
	src/qjackctlAboutForm.h \
	src/qjackctlConnectionsForm.h \
	src/qjackctlMainForm.h \
	src/qjackctlMessagesForm.h \
	src/qjackctlPatchbayForm.h \
	src/qjackctlSetupForm.h \
	src/qjackctlSocketForm.h \
	src/qjackctlStatusForm.h

sources = src/main.cpp \
	src/qjackctlAlsaConnect.cpp \
	src/qjackctlConnect.cpp \
	src/qjackctlConnectAlias.cpp \
	src/qjackctlJackConnect.cpp \
	src/qjackctlPatchbay.cpp \
	src/qjackctlPatchbayFile.cpp \
	src/qjackctlPatchbayRack.cpp \
	src/qjackctlSetup.cpp \
	src/qjackctlSystemTray.cpp \
	src/qjackctlAboutForm.cpp \
	src/qjackctlConnectionsForm.cpp \
	src/qjackctlMainForm.cpp \
	src/qjackctlMessagesForm.cpp \
	src/qjackctlPatchbayForm.cpp \
	src/qjackctlSetupForm.cpp \
	src/qjackctlSocketForm.cpp \
	src/qjackctlStatusForm.cpp

forms = \
	src/qjackctlAboutForm.ui \
	src/qjackctlConnectionsForm.ui \
	src/qjackctlMainForm.ui \
	src/qjackctlMessagesForm.ui \
	src/qjackctlPatchbayForm.ui \
	src/qjackctlSetupForm.ui \
	src/qjackctlSocketForm.ui \
	src/qjackctlStatusForm.ui

translations_sources = \
	translations/qjackctl_de.ts \
	translations/qjackctl_es.ts \
	translations/qjackctl_fr.ts \
	translations/qjackctl_ru.ts

translations_targets = \
	translations/qjackctl_de.qm \
	translations/qjackctl_es.qm \
	translations/qjackctl_fr.qm \
	translations/qjackctl_ru.qm

all:	$(name)

$(name).mak:	$(name).pro
	@$(qmake) -o $(name).mak $(name).pro

$(name):	$(name).mak $(sources) $(headers) $(forms)
	@make -f $(name).mak

%.ts:	$(name).pro $(sources) $(headers) $(forms)
	@$(lupdate) -verbose $(name).pro

%.qm:	%.ts
	@$(lrelease) -verbose $< -qm $@

install:	$(name) icons/$(name).png $(translations_targets)
	@install -d -v -m 0755 $(DESTDIR)$(prefix)/bin
	@install -d -v -m 0755 $(DESTDIR)$(prefix)/share/pixmaps
	@install -d -v -m 0755 $(DESTDIR)$(prefix)/share/applications
	@install -d -v -m 0755 $(DESTDIR)$(prefix)/share/locale
	@install -v -m 0755 $(name) $(DESTDIR)$(prefix)/bin/$(name)
	@install -v -m 0644 icons/$(name).png $(DESTDIR)$(prefix)/share/pixmaps/$(name).png
	@install -v -m 0644 $(name).desktop $(DESTDIR)$(prefix)/share/applications/$(name).desktop
	@install -v -m 0644 $(translations_targets) $(DESTDIR)$(prefix)/share/locale

uninstall:	$(DESTDIR)$(prefix)/bin/$(name)
	@rm -vf $(DESTDIR)$(prefix)/bin/$(name)
	@rm -vf $(DESTDIR)$(prefix)/share/pixmaps/$(name).png
	@rm -vf $(DESTDIR)$(prefix)/share/applications/$(name).desktop
	@rm -vf $(DESTDIR)$(prefix)/share/locale/$(translations_targets)
	@for x in $(translations_targets); do \
		rm -vf $(DESTDIR)$(prefix)/share/locale/`basename $$x`; done

clean:	$(name).mak
	@make -f $(name).mak clean
	@rm -f $(name) $(name).mak
	@rm -rf *.cache *.log *.status $(translations_targets)

